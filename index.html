<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gerador de Keys</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: #eee;
    padding: 20px;
    max-width: 700px;
    margin: auto;
  }
  h1 { text-align:center; margin-bottom: 20px; }
  input, button { padding:10px; margin:5px 0; width:100%; border-radius:5px; border:none; }
  input { background:#333; color:#eee; }
  button { background:#4CAF50; color:white; cursor:pointer; font-weight:bold; }
  button:hover { background:#45a049; }
  pre { background:#2e2e2e; padding:15px; border-radius:8px; overflow-x:auto; }
</style>
</head>
<body>

<h1>Gerador de Keys</h1>

<label>Site / domínio</label>
<input id="site" placeholder="ex: example.com" />

<label>Usuário (opcional)</label>
<input id="user" placeholder="ex: daniel" />

<button id="gen">Gerar Key</button>

<h3>Resultado</h3>
<pre id="result">Nenhuma key gerada ainda</pre>

<button id="copy">Copiar para área de transferência</button>
<button id="download">Baixar JSON</button>

<script>
function uuidv4(){
  const buf = new Uint8Array(16);
  (crypto.getRandomValues || (window.msCrypto && window.msCrypto.getRandomValues)).call(crypto, buf);
  buf[6] = (buf[6] & 0x0f) | 0x40;
  buf[8] = (buf[8] & 0x3f) | 0x80;
  const hex = Array.from(buf).map(b => b.toString(16).padStart(2,'0')).join('');
  return `${hex.slice(0,8)}-${hex.slice(8,12)}-${hex.slice(12,16)}-${hex.slice(16,20)}-${hex.slice(20)}`;
}

document.getElementById('gen').addEventListener('click', ()=>{
  const site = (document.getElementById('site').value || 'unknown').trim();
  const user = (document.getElementById('user').value || '').trim();
  const keyObj = {
    key: uuidv4(),
    user: user || null,
    created_at: new Date().toISOString(),
    notes: "gerada via site"
  };
  const out = {};
  out[site] = [keyObj];
  document.getElementById('result').textContent = JSON.stringify(out, null, 2);
});

document.getElementById('copy').addEventListener('click', async ()=>{
  const text = document.getElementById('result').textContent;
  try {
    await navigator.clipboard.writeText(text);
    alert('Copiado para área de transferência!');
  } catch(e){ alert('Falhou ao copiar: ' + e) }
});

document.getElementById('download').addEventListener('click', ()=>{
  const text = document.getElementById('result').textContent;
  const blob = new Blob([text], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'keys.json';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});
</script>

</body>
</html>
